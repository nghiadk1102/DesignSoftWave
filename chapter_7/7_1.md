7.1 Pass-through methods

Khi các layer liền kề có những điểm trừu tượng giống nhau, vấn đề thường phát sinh dưới dạng Pass-through methods. Pass-through methods là một phương thức thực hiện rất ít ngoại trừ việc gọi một phương thức khác, có chữ ký của nó tương tự hoặc giống với ký hiệu của phương thức gọi. Ví dụ, một dự án sinh viên thực hiện một trình soạn thảo văn bản GUI chứa một lớp bao gồm gần như hoàn toàn các phương thức truyền qua. Đây là phần trích xuất từ lớp đó:


Pass-through methods là một phương thức không thực hiện gì ngoại trừ việc truyền các đối số của nó cho một phương thức khác, thường có cùng API với phương thức truyền. Điều này thường chỉ ra rằng không có sự phân chia trách nhiệm rõ ràng giữa các lớp.

13 trong số 15 phương thức công khai trong lớp đó là phương thức truyền. Các phương thức truyền qua làm cho các lớp nông hơn: chúng làm tăng độ phức tạp về giao diện của lớp, điều này làm tăng thêm độ phức tạp, nhưng chúng không làm tăng tổng chức năng của hệ thống. Trong số bốn phương thức ở trên, chỉ có phương thức cuối cùng có bất kỳ chức năng nào, và thậm chí nó rất tầm thường: phương thức kiểm tra tính hợp lệ của một biến. Phương thức truyền qua cũng tạo ra sự phụ thuộc giữa các lớp: nếu chữ ký thay đổi đối với phương thức insertString trong TextArea, thì phương thức insertString trong TextDocument sẽ phải thay đổi để phù hợp.

Các phương thức truyền qua chỉ ra rằng có sự nhầm lẫn trong việc phân chia trách nhiệm giữa các lớp. Trong ví dụ trên, lớp TextDocument cung cấp phương thức insertString, nhưng chức năng chèn văn bản được thực hiện hoàn toàn trong TextArea. Đây thường là một ý tưởng tồi: giao diện của một phần chức năng phải nằm trong cùng một lớp thực thi chức năng. Khi bạn nhìn thấy các phương thức truyền từ lớp này sang lớp khác, hãy xem xét hai lớp và tự hỏi bản thân “Chính xác thì mỗi lớp này chịu trách nhiệm cho những tính năng và phần trừu tượng nào?” Bạn có thể sẽ nhận thấy rằng có sự chồng chéo về trách nhiệm giữa các lớp. Giải pháp là cấu trúc lại các lớp để mỗi lớp có một bộ trách nhiệm riêng biệt và chặt chẽ. Hình 7.1 minh họa một số cách để thực hiện việc này. Một cách tiếp cận, được thể hiện trong Hình 7.1 (b), là hiển thị lớp cấp thấp hơn trực tiếp cho những người gọi của lớp cấp cao hơn, loại bỏ tất cả trách nhiệm đối với tính năng từ lớp cấp cao hơn. Một cách tiếp cận khác là phân phối lại chức năng giữa các lớp, như trong Hình 7.1 (c). Cuối cùng, nếu các lớp không thể tách rời nhau, giải pháp tốt nhất có thể là hợp nhất chúng như trong Hình 7.1 (d). Trong ví dụ trên, có ba lớp có trách nhiệm đan xen nhau: TextDocument, TextArea và TextDocumentListener. Học sinh đã loại bỏ các Pass-through methods bằng cách di chuyển các phương thức giữa các lớp và thu gọn ba lớp chỉ thành hai, những người có trách nhiệm được phân biệt rõ ràng hơn.